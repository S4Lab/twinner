safefunctions='free@0x402160#1{void *},strncmp@0x402190#3{const char *^s!const char *^s!size_t},strcpy@0x4021c0#2{char *^s!const char *^s},fclose@0x402280#1{FILE *},opendir@0x402290#1{const char *^s},strlen@0x4022e0#1{const char *^s},strrchr@0x402370#2{const char *^s!int},setlocale@0x402650#2{int!const char *},bindtextdomain@0x4022b0#2{const char *^s!const char *^s},textdomain@0x402270#1{const char *^s},getenv@0x402120#1{const char *},isatty@0x4021e0#1{int},dcgettext@0x4022c0#2{const char *^s!const char *^s},malloc@0x402590#1{size_t},atexit@0x4142f0#1{void (*)(void)},strchr@0x402330#2{const char *^s!int},nl_langinfo@0x4025b0#1{nl_item},wcswidth@0x402210#2{const wchar_t *^s!size_t},mbstowcs@0x402230#3{wchar_t *^s!const char *^s!size_t},mempcpy@0x402690#3{void *!const void *!size_t},wcstombs@0x402710#3{char *!const wchar_t *!size_t},iswprint@0x402790#1{wint_t},ioctl@0x402400#2{int!int},localeconv@0x402220#0{},getpwuid@0x4022a0#1{uid_t},getgrgid@0x402340#1{gid_t},memcpy@0x402500#3{void *!const void *!size_t},getopt_long@0x402310#5{int!char * const * const!const char *!const struct option *!int *},dirfd@0x4024b0#1{DIR *},readdir@0x402560#1{DIR *},is_colored@0x404540#1{enum indicator_no},needs_quoting@0x404880#1{char const *^s},sort_files@0x4049a0#0{},extract_dirs_from_files@0x404bb0#2{char const *^s!bool},process_signals@0x4066d0#0{},argmatch@0x40a7e0#4{char const *^s!char const *const *!char const *!size_t},mpsort@0x40e820#3{void const **!size_t!int (*) (...)},closedir@0x402430#1{DIR *},_setjmp@0x402460#1{jmp_buf},realloc@0x402620#2{void *!size_t},mpsort_with_tmp@0x40e5e0#4{void const **!size_t!void const **!comparison_function},calculate_columns@0x405ec0#1{bool},fwrite_unlocked@0x402610#4{const void *!size_t!size_t!FILE *},mbsnwidth@0x40e3d0#3{const char *!size_t!int},get_quoting_style@0x4116c0#1{struct quoting_options const *},length_of_file_name_and_frills@0x405d40#1{const struct fileinfo *},quote_name@0x406300#7{char const *!struct quoting_options const *!int!const struct bin_str *!bool!struct obstack *!char const *},__fpending@0x4021d0#1{FILE *},fileno@0x402530#1{FILE *},__freading@0x402600#1{FILE *},queue_directory@0x404810#3{char const *^s!char const *^s!bool},file_escape@0x4048d0#2{const char *^s!bool},indent@0x404d30#2{size_t!size_t},hash_initialize@0x40c4b0#5{size_t!const Hash_tuning *!Hash_hasher!Hash_comparator!Hash_data_freer},hash_get_n_entries@0x40c060#1{const Hash_table *},close_stream@0x413c40#1{FILE *}'
sudo su sandbox -c "./obj-intel64/Twinner --input ./obj-intel64/ls --args '.' --number-of-traces 2 --pin-launcher ../../../pin.sh --tool ./obj-intel64/TwinTool.so -o ./tmp/twinner/unpacked.twin.c --tmpfolder ./tmp --safe-functions '$safefunctions' --generate-etg ./tmp/twinner/etg.dot --analysis-endpoints 0x40917d,0x409182 --stack-offset 150:149 --verbose $@"
